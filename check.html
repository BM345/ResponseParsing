<!DOCTYPE html>
<html>

<head>

    <link href="style.css" type="text/css" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>

    <script type="text/javascript" src="rpnodes.js"></script>
    <script type="text/javascript" src="responseparsing.js"></script>

    <script type="text/javascript">

        var rp = new ResponseParser();

        window.addEventListener("load", function () {

            var input = document.getElementById("input1");
            var output = document.getElementById("output1");
            var katexOutput = document.getElementById("katexOutput1");

            input.onkeyup = function (e) {
                var parseResult = rp.getParseResult(input.value.toString());

                var cache = [];
                output.innerText = JSON.stringify(parseResult, function (key, value) {
                    if (typeof value === "object" && value !== null) {
                        if (cache.indexOf(value) !== -1) {
                            return;
                        }
                        cache.push(value);
                    }
                    return value;
                }, 4);
                cache = null;

                if (parseResult !== null) {
                    katex.render(parseResult.latex, katexOutput);
                }
                else {
                    katex.render("", katexOutput);
                }

            }

        });

    </script>

    <script type="text/javascript" src="tests.js"></script>

</head>

<body>

    <div class="mainbox">
        <input type="text" id="input1" />
        <div class="katexOutput" id="katexOutput1" style="text-align: center;"></div>
        <pre><code id="output1"></code></pre>
    </div>

</body>

</html>